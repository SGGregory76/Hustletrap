<!DOCTYPE html>
<html>
<head>
  <title>Maya - Profile</title>
  <style>
    body { background: #101010; color: white; font-family: sans-serif; padding: 20px; }
    .trade-table { border-top: 1px solid #444; padding-top: 10px; margin-top: 10px; }
    .icon-text { font-size: 18px; margin-right: 6px; }
  </style>
</head>
<body>
  <h2>Maya</h2>
  <p><strong>Role:</strong> Street Dealer</p>
  <p><strong>Mood:</strong> <span id="moodText">Loading...</span></p>
  <p><strong>Currently on:</strong>
    <span class="icon-text" id="drugIcon">ðŸ’Š</span>
    <span id="drugLabel">Loading...</span>
  </p>

  <div class="trade-table" id="tradeBehavior"></div>

  <script>
    const npcId = "Maya";

    const drugData = {
      Xanax: { mood: "Detached", icon: "ðŸ’Š", trade: [
        "Sells: Minor drugs, avoids complex trades.",
        "Buys: Small quantities.",
        "Mood: May ignore low-value interactions."
      ]},
      Marijuana: { mood: "Chilled", icon: "ðŸŒ¿", trade: [
        "Sells: Weed, oils, edibles.",
        "Buys: Seeds, chill accessories.",
        "Mood: Friendly and flexible."
      ]},
      Adderall: { mood: "Alert", icon: "âš¡", trade: [
        "Sells: Focus gear, pills.",
        "Buys: Tactical items.",
        "Mood: Rushed and sharp."
      ]},
      LSD: { mood: "Unpredictable", icon: "ðŸŒˆ", trade: [
        "Sells: Mystery mixes.",
        "Buys: Experimental gear.",
        "Mood: Random outcomes."
      ]}
    };

    function rollDrug() {
      const keys = Object.keys(drugData);
      const drug = keys[Math.floor(Math.random() * keys.length)];
      localStorage.setItem(`${npcId}_drug`, drug);
      localStorage.setItem(`${npcId}_lastUpdate`, Date.now());
    }

    function getBehavior() {
      const drug = localStorage.getItem(`${npcId}_drug`) || "Xanax";
      return { drug, ...drugData[drug] };
    }

    function updateProfile() {
      const { drug, mood, icon, trade } = getBehavior();
      document.getElementById("moodText").textContent = mood;
      document.getElementById("drugIcon").textContent = icon;
      document.getElementById("drugLabel").textContent = drug;
      document.getElementById("tradeBehavior").innerHTML =
        `<h4>Trade Options:</h4><ul>${trade.map(i => `<li>${i}</li>`).join("")}</ul>`;
    }

    function refreshState() {
      const last = parseInt(localStorage.getItem(`${npcId}_lastUpdate`) || "0");
      const now = Date.now();
      if (now - last > 1000 * 60 * 4) rollDrug();
      updateProfile();
    }

    window.addEventListener("load", refreshState);
  </script>
</body>
</html>
