<!-- NPC Mission Panel Template -->
<div id="npc-wrap" style="max-width:500px;margin:20px auto;padding:16px;background:#111;border:2px solid #333;border-radius:10px;color:#eee;font-family:Roboto,sans-serif;">
  <h2 style="background:#222;padding:12px;border-radius:8px;font-size:1.5rem;text-align:center;position:relative;margin-bottom:16px;">
    <span style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);">üßë‚ÄçüöÄ</span>
    [NPC_NAME]'s Encounter
  </h2>

  <div id="npc-story" style="margin-bottom:12px;">
    <p>[STORY_PARAGRAPH_1]</p>
    <p>[STORY_PARAGRAPH_2]</p>
    <p><strong>What do you do?</strong></p>
  </div>

  <div id="npc-options" style="margin-bottom:12px;"></div>

  <div id="npc-outcome" style="text-align:center;background:#333;border-radius:6px;padding:10px;"></div>
</div>

<script>
(function(){
  const NPC_ID = 'npc-template-id'; // unique mission id
  const OS_URL = 'https://hustletrap.blogspot.com/p/burner-os.html?m=1';
  const CK = 'completedMissions';
  const SK = 'playerStats';

  let completed = JSON.parse(localStorage.getItem(CK) || '[]');
  let stats = JSON.parse(localStorage.getItem(SK) || '{}');

  stats.xp = stats.xp || 0;
  stats.rep = stats.rep || 0;
  stats.rp  = stats.rp  || 0;
  stats.cash = stats.cash || 0;
  stats.heat = stats.heat || 0;

  if (completed.includes(NPC_ID)) {
    document.getElementById('npc-story').innerHTML = `<p>You already completed this encounter.</p>`;
    document.getElementById('npc-options').innerHTML = '';
    document.getElementById('npc-outcome').innerHTML = `<p><a href="${OS_URL}" style="color:#0af;">‚Üí Return to Burner OS</a></p>`;
    return;
  }

  const choices = [
    { icon:"üí¨", text:"Say something bold",  delta:{xp:5,rep:3} },
    { icon:"üï∂Ô∏è", text:"Stay silent",       delta:{xp:3,rp:5} },
    { icon:"üí£", text:"Threaten them",      delta:{heat:2,rep:5} }
  ];

  const opts = document.getElementById('npc-options');
  const out  = document.getElementById('npc-outcome');

  choices.forEach(choice => {
    const btn = document.createElement('button');
    btn.style = "background:#222;color:#fff;border:2px solid #555;border-radius:6px;padding:10px;width:100%;font-size:1rem;margin-top:8px;cursor:pointer;";
    btn.innerHTML = `<span style="font-size:1.2rem;">${choice.icon}</span> ${choice.text}`;
    btn.onclick = () => {
      for (let [k,v] of Object.entries(choice.delta)) {
        stats[k] = (stats[k]||0) + v;
      }

      stats.xp += 2;
      stats.rep += 1;

      localStorage.setItem(SK, JSON.stringify(stats));
      completed.push(NPC_ID);
      localStorage.setItem(CK, JSON.stringify(completed));

      opts.innerHTML = '';
      out.innerHTML = `
        <p><strong>Stats Updated!</strong><br>
        XP: ${stats.xp} | REP: ${stats.rep} | RP: ${stats.rp} | Heat: ${stats.heat} | Cash: $${stats.cash}</p>
        <p><a href="${OS_URL}" style="color:#0af;">‚Üí Return to Burner OS</a></p>
      `;
    };
    opts.appendChild(btn);
  });
})();
</script>
